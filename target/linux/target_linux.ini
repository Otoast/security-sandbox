################################################################################
# TARGET MACHINES INVENTORY FILE
################################################################################
#
# Purpose:
#   Defines all target machines that will be monitored by Elastic Agents.
#   These machines will have agents installed that send logs and metrics
#   to the central logging server.
#
# Usage:
#   ansible-playbook -i target_linux.ini main.yml
#
# Configuration Instructions:
#   1. Replace <##TARGET_MACHINE_IP_X##> placeholders with actual IPs
#   2. Add as many target machines as needed (one per line)
#   3. Update ansible_user if not using 'ubuntu'
#   4. Update ansible_ssh_private_key_file path to your SSH key
#   5. Ensure logging server is deployed first!
#
################################################################################

[target_linux]
# Add target machine IP addresses here (one per line)
# You can monitor as many machines as needed
# Examples:
#   10.0.2.10
#   10.0.2.11
#   10.0.2.12
<##TARGET_MACHINE_IP_1##>
<##TARGET_MACHINE_IP_2##>
# Add more target machines as needed

[target_linux:vars]
# SSH Connection Settings
# User account for SSH connection (must have sudo privileges)
ansible_user=ubuntu

# Path to SSH private key file
# Should be the same key used for all target machines
# For AWS: Use the .pem key file downloaded when creating EC2 instances
ansible_ssh_private_key_file=~/.ssh/your-key.pem

# Connection type (SSH for Linux)
ansible_connection=ssh

# Python interpreter path (Python 3 required)
ansible_python_interpreter=/usr/bin/python3

# Privilege escalation (required for installing agent)
ansible_become=yes
ansible_become_method=sudo

################################################################################
# CONFIGURATION EXAMPLES
################################################################################
#
# Example 1: Multiple AWS EC2 Instances
#   [target_linux]
#   54.123.45.10
#   54.123.45.11
#   54.123.45.12
#   
#   [target_linux:vars]
#   ansible_user=ubuntu
#   ansible_ssh_private_key_file=~/.ssh/aws-key.pem
#
# Example 2: Mixed Environment with Hostnames
#   [target_linux]
#   web-server-1.example.com
#   web-server-2.example.com
#   db-server.example.com
#   
#   [target_linux:vars]
#   ansible_user=ubuntu
#   ansible_ssh_private_key_file=~/.ssh/production-key.pem
#
# Example 3: Grouped by Function
#   [web_servers]
#   10.0.2.10
#   10.0.2.11
#   
#   [database_servers]
#   10.0.3.10
#   10.0.3.11
#   
#   [target_linux:children]
#   web_servers
#   database_servers
#   
#   [target_linux:vars]
#   ansible_user=ubuntu
#   ansible_ssh_private_key_file=~/.ssh/your-key.pem
#
# Example 4: Different SSH Keys per Host
#   [target_linux]
#   10.0.2.10 ansible_ssh_private_key_file=~/.ssh/web-key.pem
#   10.0.2.20 ansible_ssh_private_key_file=~/.ssh/db-key.pem
#   
#   [target_linux:vars]
#   ansible_user=ubuntu
#
# Example 5: Mix of Users
#   [target_linux]
#   10.0.2.10 ansible_user=ubuntu
#   10.0.2.11 ansible_user=centos
#   10.0.2.12 ansible_user=ec2-user
#   
#   [target_linux:vars]
#   ansible_ssh_private_key_file=~/.ssh/your-key.pem
#
################################################################################
# TESTING SSH CONNECTION
################################################################################
#
# Before running the playbook, test SSH connections to all targets:
#   
#   ssh -i ~/.ssh/your-key.pem ubuntu@<target-ip>
#
# Test Ansible connectivity to all targets:
#   ansible -i target_linux.ini target_linux -m ping
#
# Expected output (for each host):
#   <target-ip> | SUCCESS => {
#       "changed": false,
#       "ping": "pong"
#   }
#
# Test connectivity to specific hosts:
#   ansible -i target_linux.ini target_linux --limit "10.0.2.10" -m ping
#
################################################################################
# ANSIBLE PATTERNS
################################################################################
#
# Deploy to all targets:
#   ansible-playbook -i target_linux.ini main.yml
#
# Deploy to specific targets:
#   ansible-playbook -i target_linux.ini --limit "10.0.2.10,10.0.2.11" main.yml
#
# Deploy to targets matching a pattern:
#   ansible-playbook -i target_linux.ini --limit "10.0.2.*" main.yml
#
# Deploy one at a time (serial):
#   ansible-playbook -i target_linux.ini -f 1 main.yml
#
# Deploy to 10 hosts in parallel:
#   ansible-playbook -i target_linux.ini -f 10 main.yml
#
# Dry run (check mode):
#   ansible-playbook -i target_linux.ini --check main.yml
#
################################################################################
# PREREQUISITES
################################################################################
#
# Before deploying agents to targets:
#
# 1. ✅ Logging server must be deployed first
#    cd ../../logging/linux
#    ansible-playbook -i logging_server.ini main.yml
#
# 2. ✅ .fleet_credentials.yml must exist
#    Check: ls ../../.fleet_credentials.yml
#
# 3. ✅ Target machines must reach logging server port 8220
#    Test: telnet <logging-server-ip> 8220
#
# 4. ✅ SSH access configured for all targets
#    Test: ansible -i target_linux.ini target_linux -m ping
#
################################################################################
# TROUBLESHOOTING
################################################################################
#
# Connection timeout to some hosts:
#   - Check security group/firewall allows SSH (port 22)
#   - Verify IP addresses are correct
#   - Ensure all servers are running
#   - Try connecting to each individually
#
# Permission denied (publickey):
#   - Check SSH key path is correct
#   - Verify key has correct permissions: chmod 400 ~/.ssh/your-key.pem
#   - Ensure ansible_user is correct for each system
#   - Different OS may use different default users:
#     * Ubuntu: ubuntu
#     * CentOS/RHEL: centos or ec2-user
#     * Amazon Linux: ec2-user
#
# Some hosts succeed, others fail:
#   - Check failed hosts individually
#   - May need different configurations per host
#   - Use host-specific variables as shown in examples
#
# Agent enrollment fails:
#   - Ensure logging server was deployed first
#   - Check .fleet_credentials.yml exists and is valid
#   - Verify targets can reach logging server on port 8220
#   - Check Fleet Server is running on logging server
#
################################################################################
